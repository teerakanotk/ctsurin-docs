import { Steps } from 'nextra/components'

# Security Policy

Security Policy คือชุดของกฎที่กำหนดว่าทราฟฟิก (ข้อมูล) จะถูกอนุญาตให้ผ่าน หรือถูกปฏิเสธ ไม่ให้ผ่านจากจุดหนึ่งไปยังอีกจุดหนึ่งได้อย่างไร

นโยบายเหล่านี้เปรียบเสมือนด่านตรวจที่คอยตรวจสอบ "ผู้สัญจร" (ข้อมูล) ว่ามีคุณสมบัติตรงตามที่กำหนดไว้หรือไม่ หากตรงก็อนุญาตให้ผ่าน หากไม่ตรงก็ปฏิเสธ

## ลำดับการประมวลผล

- อุปกรณ์จะเริ่มตรวจสอบนโยบายจากลำดับแรกสุด (บนสุด) ไปยังนโยบายถัดๆ ไปตามลำดับ

- ทันทีที่ทราฟฟิกนั้น "ตรงกัน" (Match) กับเงื่อนไขทั้งหมดของนโยบายใดนโยบายหนึ่ง อุปกรณ์จะทำการตัดสินใจตาม "Action" (Permit หรือ Deny) ที่ระบุไว้ในนโยบายนั้นทันที

- หลังจากที่พบ Match แล้ว อุปกรณ์จะหยุดประมวลผลนโยบายอื่นๆ ที่อยู่ถัดลงมาทันที ไม่ว่านโยบายเหล่านั้นจะมีเงื่อนไขที่ตรงกันหรือไม่ก็ตาม

> เพิ่มเติม: โดยค่าเริ่มต้นจะเป็น Default Deny อยู่ด้านล่างสุด ซึ่งหมายความว่า หากไม่ตรงกับนโยบายใดๆ เลยดังข้างต้น คำขอนั้นจะถูกปฏิเสธโดยอัตโนมัติ

## หัวข้อที่ใช้งานบ่อยในการตั้งค่า Security Policy

### General Settings

- Name: เป็นชื่อที่เรากำหนดขึ้นมาเองเพื่อให้จำได้ง่ายว่านโยบายนี้ใช้สำหรับอะไร

- Description: รายละเอียดเพิ่มเติมของนโยบาย เพื่อให้เข้าใจวัตถุประสงค์ได้ชัดเจนยิ่งขึ้น

### Source and Destination

- Source Zone: ระบุว่าทราฟฟิกนี้มาจากโซนเครือข่ายใด เช่น โซนภายใน (trust), โซนภายนอก (untrust) หรือโซน DMZ

- Destination Zone: ระบุว่าทราฟฟิกนี้จะมุ่งหน้าไปยังโซนเครือข่ายใด

- Source Address/Region: ระบุที่อยู่ IP หรือกลุ่มของที่อยู่ IP ที่เป็นต้นกำเนิดของทราฟฟิก เช่น เครื่องคอมพิวเตอร์ลูกข่าย หรือเครือข่ายย่อย

- Destination Address/Region: ระบุที่อยู่ IP หรือกลุ่มของที่อยู่ IP ที่เป็นปลายทางของทราฟฟิก เช่น เซิร์ฟเวอร์ หรือเว็บไซต์

### User and Service

- User: ในบางกรณี สามารถระบุผู้ใช้งานเฉพาะเจาะจงที่ได้รับอนุญาตให้ใช้กฎนี้ได้ (มักใช้กับการยืนยันตัวตนผ่าน Active Directory)

- Service: ระบุประเภทของบริการหรือโปรโตคอลที่ต้องการอนุญาตหรือปฏิเสธ เช่น HTTP (พอร์ต 80), HTTPS (พอร์ต 443), FTP (พอร์ต 21) หรือ ICMP (สำหรับ Ping)

- Schedule: กำหนดช่วงเวลาที่นโยบายนี้จะเปิดใช้งาน เช่น เฉพาะเวลาทำการ หรือเฉพาะวันหยุดสุดสัปดาห์

### Action

- Permit: หมายถึงการอนุญาตให้ทราฟฟิกที่ตรงตามเงื่อนไขทั้งหมดผ่านไปได้

- Deny: หมายถึงการบล็อก หรือปฏิเสธไม่ให้ทราฟฟิกที่ตรงตามเงื่อนไขผ่านไปได้

### Content Security

- Antivirus: เปิดใช้งานการสแกนไวรัสสำหรับทราฟฟิกที่ผ่านกฎนี้

- Intrusion Prevention: เปิดใช้งานระบบป้องกันการบุกรุก เพื่อตรวจจับและบล็อกการโจมตีที่รู้จัก

- URL Filtering: เปิดใช้งานการกรองเว็บไซต์ตามหมวดหมู่ หรือตามรายการที่กำหนด

### Other Options

- บันทึก การเปิดใช้งานบันทึกเหตุการณ์ (Log) จะช่วยให้เราสามารถตรวจสอบย้อนหลังได้ว่ามีทราฟฟิกใดที่ถูกอนุญาตหรือปฏิเสธไปบ้าง

    ![sec-policy-1](/images/huawei-usg6530e/sec-policy-1.png)

    ![sec-policy-2](/images/huawei-usg6530e/sec-policy-2.png)

## ตัวอย่าง

ต้องการอนุญาตให้ 192.168.0.0/24 ที่อยู่เครือข่ายภายใน (trust) สามารถ PING ไปยังเซิร์ฟเวอร์ 8.8.8.8 ที่อยู่เครือข่ายภายนอกได้ (untrust)

<Steps>

### Add Security Policy

ไปที่เมนู Policy > Security Policy > คลิก Add Security Policy

### กรอกข้อมูลดังนี้

- Name: `กรอกชื่อให้สอดคล้องกับ Policy`

- Source Zone: `trust`

- Destination Zone: `untrust`

- Source Address/Region: `192.168.0.0/24`

- Destination Address/Region: `8.8.8.8/32`

- Service: `icmp`

- Action: `Permit`

    ![sec-policy-3](/images/huawei-usg6530e/sec-policy-3.png)

### บันทึก

คลิก OK เพื่อบันทึก

### ทดสอบ

ลอง Ping จากเครื่อง Client ที่อยู่ในเครือข่าย 192.168.0.0/24 ไปยัง 8.8.8.8 หากได้รับ Reply กลับมา แสดงว่าการตั้งค่าถูกต้อง

</Steps>