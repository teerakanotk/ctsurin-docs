import { Steps } from 'nextra/components'

# Zone

ส่วนหนึ่งของ Domain Name System (DNS) namespace ที่ถูกกำหนดให้มีการบริหารจัดการโดยเฉพาะ มักจะหมายถึงส่วนของชื่อโดเมนและโดเมนย่อยทั้งหมดที่อยู่ภายใต้การควบคุมของผู้ดูแลระบบหรือองค์กรหนึ่งๆ

ลองนึกภาพ DNS ทั้งหมดเป็นต้นไม้ขนาดใหญ่ที่มีรากและกิ่งก้านสาขามากมาย แต่ละกิ่งก้านก็คือโดเมนต่างๆ (เช่น .com, .org, .net, google.com, example.com) DNS Zone ก็เปรียบเสมือนการ "ตัดแบ่ง" กิ่งก้านบางส่วนของต้นไม้นี้ออกไป เพื่อให้ผู้ดูแลระบบเฉพาะคน/องค์กร สามารถบริหารจัดการข้อมูลของโดเมนและโดเมนย่อยเหล่านั้นได้อย่างอิสระ

## ประเภทของ Zone

- Forward Lookup Zone: เป็นโซนที่ใช้ในการแปลงชื่อโดเมน (Hostname) ไปเป็น IP Address (เช่น www.example.com > 192.168.1.1) เป็นการใช้งานที่พบได้บ่อยที่สุด
- Reverse Lookup Zone: เป็นโซนที่ใช้ในการแปลง IP Address ไปเป็นชื่อโดเมน (Hostname) หรือที่เรียกว่า Reverse DNS Lookup (เช่น 192.168.1.1 > www.example.com) ซึ่งมีประโยชน์สำหรับการตรวจสอบความถูกต้องของอีเมลหรือการวิเคราะห์ Log

## ขั้นตอนการจัดการ Forward Zone

<Steps>

### เข้าสู่ระบบ Technitium DNS

เปิดเว็บเบราว์เซอร์แล้วพิมพ์ IP Address ตามด้วยพอร์ต 5380

```
http://ip_address:5380
```

### ไปที่เมนู Zones

![technitium-dns-4](/images/technitium/dns-4.png)

### สร้างโซนใหม่

- คลิกปุ่ม **Add Zone**
- Zone: ระบุโดเมนที่ต้องการสร้าง
- Type: เลือก `Primary`
- Zone Serial: ติ๊ก ☑️ Use SOA Serial Date Scheme

![technitium-dns-5](/images/technitium/dns-5.png)

- จากนั้นคลิกปุ่ม **Add**

### เพิ่ม A Record สำหรับ DNS Server

- คลิกปุ่ม **Add Record** ที่ Forward zone

![technitium-dns-6](/images/technitium/dns-6.png)

- Name: ระบุชื่อของเซิร์ฟเวอร์
- Type: เลือก A
- IPv4 Address: ระบุที่อยู่ไอพีของเซิร์ฟเวอร์

![technitium-dns-7](/images/technitium/dns-7.png)

- คลิกปุ่ม **Save**
- ผลลัพธ์ที่ควรได้

![technitium-dns-8](/images/technitium/dns-8.png)

</Steps>

<br/>

## ขั้นตอนการจัดการ Reverse Zone

<Steps>

### เข้าสู่ระบบ Technitium DNS

เปิดเว็บเบราว์เซอร์แล้วพิมพ์ IP Address ตามด้วยพอร์ต 5380

```
http://ip_address:5380
```

### ไปที่เมนู Zones

![technitium-dns-4](/images/technitium/dns-4.png)

### สร้างโซนใหม่

- คลิกปุ่ม **Add Zone**
- Zone: ระบุ Reverse Zone ที่ต้องการสร้าง (เช่น 10.11.254.0/24)
- Type: เลือก Primary Zone
- Zone Serial: ติ๊ก ☑️ Use SOA Serial Date Scheme

![technitium-dns-9](/images/technitium/dns-9.png)

- คลิกปุ่ม **Add**

### เพิ่ม PTR Record สำหรับ DNS Server

- คลิกปุ่ม **Add Record** ภายใน Reverse zone

![technitium-dns-10](/images/technitium/dns-10.png)

- กำหนดค่าดังนี้:
   - Name: ระบุ IP Address หลักสุดท้าย
   - Type: เลือก PTR
   - Domain Name: ระบุ FQDN ของเซิร์ฟเวอร์

![technitium-dns-11](/images/technitium/dns-11.png)

- คลิกปุ่ม Save
- ผลลัพธ์ที่ควรได้

![technitium-dns-12](/images/technitium/dns-12.png)

</Steps>

## ทดสอบการทำงานของ DNS Server

หลังจากที่คุณได้ตั้งค่า DNS Server และ Zones เรียบร้อยแล้ว คุณสามารถทดสอบการทำงานของ DNS Server ได้โดยใช้เครื่องคอมพิวเตอร์ที่ติดตั้ง Windows

### 1\. ตั้งค่า Network Adapter

- เปิด Control Panel
- ไปที่ Network and Internet \> Network and Sharing Center
- ที่แถบด้านซ้าย คลิก Change adapter settings
- คลิกขวาที่ Network adapter ที่เชื่อมต่อกับเครือข่ายเดียวกับ DNS Server และเลือก Properties
- เลือก Internet Protocol Version 4 (TCP/IPv4) และคลิกปุ่ม Properties
- เลือก Use the following DNS server addresses และกำหนดค่า DNS:
   - Preferred DNS server: ใส่ IP Address ของ DNS Server หลัก
   - Alternate DNS server: ใส่ IP Address ของ DNS Server สำรอง (ถ้ามี)

### 2\. nslookup

- เปิด Command Prompt แล้วพิมพ์คำสั่ง `nslookup` เพื่อเข้าสู่โหมดการค้นหา DNS

```cmd
C:\> nslookup
Default Server: Unknown
Address: 192.168.100.1

>
```

- พิมพ์คำสั่งต่อไปนี้เพื่อเปลี่ยนเซิร์ฟเวอร์ DNS ที่ใช้ในการค้นหา

```cmd
> server <nameserver>
```

> [!NOTE]
>
> แทนที่ `<nameserver>` ด้วยชื่อ FQDN ของเซิร์ฟเวอร์ DNS ของคุณ (เช่น `ns1.ctsurin.local`)

```cmd
> server ns1.ctsurin.local

Default Server: ns1.ctsurin.local
Address: 10.11.254.10
```

- หากผลลัพธ์ที่ได้คล้ายกับตัวอย่างข้างต้น แสดงว่าตั้งค่าถูกต้อง

## วิธีแก้ไขปัญหา Non-existent domain

- หากคุณได้รับข้อความแสดงข้อผิดพลาดว่า "Non-existent domain" แสดงว่า DNS Server ไม่สามารถค้นหาชื่อโดเมนที่ระบุได้
- ให้ลองเปลี่ยน DNS Server ที่ใช้ในการค้นหา โดยใช้คำสั่ง `server <ip_address>` แทน

```cmd
> server 10.11.254.10

Default Server:  [10.11.254.10]
Address:  10.11.254.10
```

- จากนั้นลองใช้คำสั่ง `server <nameserver>` อีกครั้ง
- ผลลัพธ์ที่ควรได้

```cmd
> server ns1.ctsurin.local

Default Server:  ns1.ctsurin.local
Address:  10.11.254.10
```